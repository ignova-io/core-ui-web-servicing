"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[7888],{95368:(e,n,i)=>{i.d(n,{H:()=>d});var s=i(63789),t=i(7353),o=i(34535),a=i(94496),l=i(57058),r=i(70579);function d(e){var n,i,s,o,d,x,p,h,u,v,m,g;let{sx:j,imgUrl:b,action:y,filled:f,slotProps:A,description:C,title:w="No data",...k}=e;return(0,r.jsxs)(c,{filled:f,sx:j,...k,children:[(0,r.jsx)(t.A,{component:"img",alt:"Empty content",src:null!==b&&void 0!==b?b:`${l.P.assetsDir}/assets/icons/empty/ic-content.svg`,...null===A||void 0===A?void 0:A.img,sx:[{width:1,maxWidth:160},...Array.isArray(null===A||void 0===A||null===(n=A.img)||void 0===n?void 0:n.sx)?null!==(i=null===A||void 0===A||null===(s=A.img)||void 0===s?void 0:s.sx)&&void 0!==i?i:[]:[null===A||void 0===A||null===(o=A.img)||void 0===o?void 0:o.sx]]}),w&&(0,r.jsx)(a.A,{variant:"h6",...null===A||void 0===A?void 0:A.title,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null===A||void 0===A||null===(d=A.title)||void 0===d?void 0:d.sx)?null!==(x=null===A||void 0===A||null===(p=A.title)||void 0===p?void 0:p.sx)&&void 0!==x?x:[]:[null===A||void 0===A||null===(h=A.title)||void 0===h?void 0:h.sx]],children:w}),C&&(0,r.jsx)(a.A,{variant:"body2",...null===A||void 0===A?void 0:A.description,sx:[{mt:1,textAlign:"center",color:"text.disabled"},...Array.isArray(null===A||void 0===A||null===(u=A.description)||void 0===u?void 0:u.sx)?null!==(v=null===A||void 0===A||null===(m=A.description)||void 0===m?void 0:m.sx)&&void 0!==v?v:[]:[null===A||void 0===A||null===(g=A.description)||void 0===g?void 0:g.sx]],children:C}),y&&y]})}const c=(0,o.Ay)("div",{shouldForwardProp:e=>!["filled","sx"].includes(e)})((e=>{let{filled:n,theme:i}=e;return{flexGrow:1,height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",padding:i.spacing(0,3),...n&&{borderRadius:2*i.shape.borderRadius,backgroundColor:(0,s.IG)(i.vars.palette.grey["500Channel"],.04),border:`dashed 1px ${(0,s.IG)(i.vars.palette.grey["500Channel"],.08)}`}}}))},57653:(e,n,i)=>{i.d(n,{Y:()=>m,x:()=>b});var s=i(63789),t=i(91706),o=i(7353),a=i(35151),l=i(80033),r=i(42993),d=i(14829),c=i(49502),x=i(57483),p=i(60519);function h(e){let{disableZoom:n,disableVideo:i,disableCaptions:s,disableSlideshow:t,disableThumbnails:o,disableFullscreen:a}=e,h=[d.A,x.A,c.A,p.A,r.A,l.A];return o&&(h=h.filter((e=>e!==p.A))),s&&(h=h.filter((e=>e!==d.A))),a&&(h=h.filter((e=>e!==x.A))),t&&(h=h.filter((e=>e!==c.A))),n&&(h=h.filter((e=>e!==l.A))),i&&(h=h.filter((e=>e!==r.A))),h}const u={root:(0,i(7445).L)("lightbox__root")};var v=i(70579);function m(e){let{slides:n,disableZoom:i,disableVideo:o,disableTotal:l,disableCaptions:r,disableSlideshow:d,disableThumbnails:c,disableFullscreen:x,onGetCurrentIndex:p,className:m,...j}=e;const b=n?n.length:0;return(0,v.jsx)(t.Ay,{slides:n,animation:{swipe:240},carousel:{finite:b<5},controller:{closeOnBackdropClick:!0},plugins:h({disableZoom:i,disableVideo:o,disableCaptions:r,disableSlideshow:d,disableThumbnails:c,disableFullscreen:x}),on:{view:e=>{let{index:n}=e;p&&p(n)}},toolbar:{buttons:[(0,v.jsx)(g,{totalItems:b,disableTotal:l},0),"close"]},render:{iconClose:()=>(0,v.jsx)(a.W,{width:24,icon:"carbon:close"}),iconZoomIn:()=>(0,v.jsx)(a.W,{width:24,icon:"carbon:zoom-in"}),iconZoomOut:()=>(0,v.jsx)(a.W,{width:24,icon:"carbon:zoom-out"}),iconSlideshowPlay:()=>(0,v.jsx)(a.W,{width:24,icon:"carbon:play"}),iconSlideshowPause:()=>(0,v.jsx)(a.W,{width:24,icon:"carbon:pause"}),iconPrev:()=>(0,v.jsx)(a.W,{width:32,icon:"carbon:chevron-left"}),iconNext:()=>(0,v.jsx)(a.W,{width:32,icon:"carbon:chevron-right"}),iconExitFullscreen:()=>(0,v.jsx)(a.W,{width:24,icon:"carbon:center-to-fit"}),iconEnterFullscreen:()=>(0,v.jsx)(a.W,{width:24,icon:"carbon:fit-to-screen"})},className:(0,s.zP)([u.root,m]),...j})}function g(e){let{totalItems:n,disableTotal:i}=e;const{currentIndex:s}=(0,t.mp)();return i?null:(0,v.jsxs)(o.A,{component:"span",className:"yarl__button",sx:{typography:"body2",alignItems:"center",display:"inline-flex",justifyContent:"center"},children:[(0,v.jsxs)("strong",{children:[" ",s+1," "]})," / ",n]})}var j=i(65043);function b(e){const[n,i]=(0,j.useState)(-1);return{selected:n,open:n>=0,onOpen:(0,j.useCallback)((n=>{const s=e.findIndex((e=>"video"===e.type?e.poster===n:e.src===n));i(s)}),[e]),onClose:(0,j.useCallback)((()=>{i(-1)}),[]),setSelected:i}}},7888:(e,n,i)=>{i.r(n),i.d(n,{default:()=>qe});var s=i(49367),t=i(57058),o=i(65043),a=i(94496),l=i(48407),r=i(67132),d=i(91777),c=i(37274),x=i(27341),p=i(73715),h=i(54903);const u=!1,v=h.vZ.chat,m={revalidateIfStale:u,revalidateOnFocus:u,revalidateOnReconnect:u};async function g(e){const n=[v,{params:{endpoint:"conversations"}}],i={conversationData:e},s=await h.Ay.post(v,i);return(0,p.k)(n,(n=>{const i=[...n.conversations,e];return{...n,conversations:i}}),!1),s.data}var j=i(95368),b=i(62575),y=i(7353),f=i(584),A=i(42788),C=i(26240),w=i(71716),k=i(85442),I=i(51787),W=i(20036),$=i(73705),D=i(35151),R=i(62025),E=i(34535),S=i(47473),O=i(38968),N=i(70579);const U=(0,E.Ay)((e=>{let{selected:n,children:i,disabled:s,...t}=e;return(0,N.jsxs)(O.A,{disabled:s,...t,children:[i,(0,N.jsx)(D.W,{width:16,icon:!n||s?"eva:arrow-ios-forward-fill":"eva:arrow-ios-downward-fill"})]})}))((e=>{let{theme:n}=e;return{...n.typography.overline,height:40,paddingLeft:n.spacing(2.5),justifyContent:"space-between",paddingRight:n.spacing(1.5),color:n.vars.palette.text.secondary,backgroundColor:n.vars.palette.background.neutral}})),T=(0,E.Ay)(S.A)((e=>{let{theme:n}=e;return{top:84,left:0,zIndex:9,width:32,height:32,position:"absolute",borderRadius:"0 12px 12px 0",boxShadow:n.vars.customShadows.primary,color:n.vars.palette.primary.contrastText,backgroundColor:n.vars.palette.primary.main,transition:n.transitions.create(["all"],{duration:n.transitions.duration.shorter}),"&:hover":{backgroundColor:n.vars.palette.primary.darker}}}));var G=i(29694),P=i(60587),F=i(46936),L=i(48734);function M(e){let{selected:n,collapse:i,conversation:s,onCloseMobile:t}=e;const{user:d}=(0,b.E)(),c=(0,r.rd)(),x=(0,C.A)(),m=(0,k.A)(x.breakpoints.up("md")),{group:g,displayName:j,displayText:f,participants:A,lastActivity:w,hasOnlineInGroup:I}=function(e){let{currentUserId:n,conversation:i}=e;const{messages:s,participants:t}=i,o=t.filter((e=>e.id!==n)),a=s[s.length-1],l=o.length>1,r=o.map((e=>e.name)).join(", "),d=!!l&&o.map((e=>e.status)).includes("online");let c="";a&&(c=`${a.senderId===n?"You: ":""}${"image"===a.contentType?"Sent a photo":a.body}`);return{group:l,displayName:r,displayText:c,participants:o,lastActivity:a.createdAt,hasOnlineInGroup:d}}({conversation:s,currentUserId:`${null===d||void 0===d?void 0:d.id}`}),W=A[0],D=(0,o.useCallback)((async()=>{try{m||t(),await async function(e){u&&await h.Ay.get(v,{params:{conversationId:e,endpoint:"mark-as-seen"}}),(0,p.k)([v,{params:{endpoint:"conversations"}}],(n=>{const i=n.conversations.map((n=>n.id===e?{...n,unreadCount:0}:n));return{...n,conversations:i}}),!1)}(s.id);const e=`${l.f.dashboard.chat}?id=${s.id}`;(0,o.startTransition)((()=>{c.push(e)}))}catch(e){console.error(e)}}),[s.id,m,t,c]);return(0,N.jsx)(y.A,{component:"li",sx:{display:"flex"},children:(0,N.jsxs)(O.A,{onClick:D,sx:{py:1.5,px:2.5,gap:2,...n&&{bgcolor:"action.selected"}},children:[(0,N.jsx)(G.A,{color:"error",overlap:"circular",badgeContent:i?s.unreadCount:0,children:g?(0,N.jsx)(G.A,{variant:I?"online":"invisible",badgeContent:"",children:(0,N.jsx)(F.A,{variant:"compact",sx:{width:48,height:48},children:A.slice(0,2).map((e=>(0,N.jsx)(P.A,{alt:e.name,src:e.avatarUrl},e.id)))})}):(0,N.jsx)(G.A,{variant:null===W||void 0===W?void 0:W.status,badgeContent:"",children:(0,N.jsx)(P.A,{alt:null===W||void 0===W?void 0:W.name,src:null===W||void 0===W?void 0:W.avatarUrl,sx:{width:48,height:48}})})}),!i&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(L.A,{primary:j,secondary:f,slotProps:{primary:{noWrap:!0},secondary:{noWrap:!0,sx:{...s.unreadCount&&{color:"text.primary",fontWeight:"fontWeightSemiBold"}}}}}),(0,N.jsxs)(y.A,{sx:{display:"flex",alignSelf:"stretch",alignItems:"flex-end",flexDirection:"column"},children:[(0,N.jsx)(a.A,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:(0,$.kH)(w)}),!!s.unreadCount&&(0,N.jsx)(y.A,{component:"span",sx:{width:8,height:8,borderRadius:"50%",bgcolor:"info.main"}})]})]})]})})}var z=i(81772),_=i(72221),H=i(39336),V=i(69392),q=i(30922),Z=i(94814),B=i(53193),K=i(40090),Y=i(92546),X=i(62559),J=i(1470),Q=i(50031);function ee(){var e;const{user:n}=(0,b.E)(),i=(0,z.fP)(),[s,t]=(0,o.useState)("online"),a=(0,o.useCallback)((e=>{t(e.target.value)}),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(G.A,{variant:s,badgeContent:"",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,N.jsx)(P.A,{src:null===n||void 0===n?void 0:n.photoURL,alt:null===n||void 0===n?void 0:n.displayName,onClick:i.onOpen,sx:{cursor:"pointer",width:48,height:48},children:null===n||void 0===n||null===(e=n.displayName)||void 0===e?void 0:e.charAt(0).toUpperCase()})}),(0,N.jsxs)(Q.t,{open:i.open,anchorEl:i.anchorEl,onClose:i.onClose,slotProps:{paper:{sx:{p:0,ml:0,mt:.5}},arrow:{placement:"top-left"}},children:[(0,N.jsxs)(y.A,{sx:{py:2,pr:1,pl:2,gap:2,display:"flex",alignItems:"center"},children:[(0,N.jsx)(L.A,{primary:null===n||void 0===n?void 0:n.displayName,secondary:null===n||void 0===n?void 0:n.email}),(0,N.jsx)(V.A,{title:"Log out",children:(0,N.jsx)(w.A,{color:"error",children:(0,N.jsx)(D.W,{icon:"ic:round-power-settings-new"})})})]}),(0,N.jsx)(H.A,{sx:{borderStyle:"dashed"}}),(0,N.jsxs)(q.A,{sx:{my:.5,px:.5},children:[(0,N.jsxs)(Z.A,{children:[(0,N.jsx)(G.A,{variant:s,badgeContent:"",sx:{width:24,height:24,alignItems:"center",justifyContent:"center",[`& .${Y.A.badge}`]:{width:12,height:12,transform:"unset",position:"static"}}}),(0,N.jsx)(B.A,{fullWidth:!0,children:(0,N.jsx)(_.A,{native:!0,fullWidth:!0,value:s,onChange:a,input:(0,N.jsx)(X.Ay,{}),inputProps:{id:"chat-status-select"},sx:{[`& .${K.A.root}`]:{right:0},[`& .${J.A.input}`]:{typography:"body2",textTransform:"capitalize"}},children:["online","always","busy","offline"].map((e=>(0,N.jsx)("option",{value:e,children:e},e)))})})]}),(0,N.jsxs)(Z.A,{children:[(0,N.jsx)(D.W,{width:24,icon:"solar:user-id-bold"}),"Profile"]}),(0,N.jsxs)(Z.A,{children:[(0,N.jsx)(D.W,{width:24,icon:"eva:settings-2-fill"}),"Settings"]})]})]})]})}var ne=i(88911),ie=i(78185),se=i(97334);function te(e){let{sx:n,itemCount:i=6,...s}=e;return Array.from({length:i},((e,i)=>(0,N.jsxs)(y.A,{sx:[()=>({gap:2,px:2.5,py:1.5,display:"flex",alignItems:"center"}),...Array.isArray(n)?n:[n]],...s,children:[(0,N.jsx)(ie.A,{variant:"circular",sx:{width:48,height:48}}),(0,N.jsxs)(ne.A,{spacing:1,flexGrow:1,children:[(0,N.jsx)(ie.A,{sx:{width:.75,height:10}}),(0,N.jsx)(ie.A,{sx:{width:.5,height:10}})]})]},i)))}function oe(e){let{sx:n,...i}=e;return(0,N.jsxs)(y.A,{sx:[{width:1,display:"flex",alignItems:"center"},...Array.isArray(n)?n:[n]],...i,children:[(0,N.jsx)(ie.A,{variant:"circular",sx:{width:40,height:40}}),(0,N.jsxs)(ne.A,{spacing:1,flexGrow:1,sx:{mx:2},children:[(0,N.jsx)(ie.A,{sx:{width:96,height:10}}),(0,N.jsx)(ie.A,{sx:{width:40,height:10}})]}),(0,N.jsx)(ie.A,{variant:"circular",sx:{width:28,height:28}}),(0,N.jsx)(ie.A,{variant:"circular",sx:{width:28,height:28,mx:1}}),(0,N.jsx)(ie.A,{variant:"circular",sx:{width:28,height:28,mr:1}})]})}function ae(e){let{sx:n,...i}=e;return(0,N.jsx)(y.A,{sx:[()=>({pt:5,flexGrow:1,display:"flex",flexDirection:"column"}),...Array.isArray(n)?n:[n]],...i,children:(0,N.jsxs)(ne.A,{alignItems:"center",children:[(0,N.jsx)(ie.A,{variant:"circular",sx:{width:96,height:96}}),(0,N.jsx)(ie.A,{sx:{mb:1,mt:2,height:10,width:.65}}),(0,N.jsx)(ie.A,{sx:{mb:5,width:.35,height:10}}),(0,N.jsx)(se.A,{color:"inherit",thickness:2})]})})}var le=i(91507);function re(e){let{query:n,results:i,onClickResult:s}=e;const t=i.length,o=!t&&!!n;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(a.A,{variant:"h6",sx:{px:2.5,mb:2},children:["Contacts (",t,")"]}),o?(0,N.jsx)(le.c,{query:n,sx:{p:3,mx:"auto",width:"calc(100% - 40px)",bgcolor:"background.neutral"}}):(0,N.jsx)("nav",{children:(0,N.jsx)(y.A,{component:"ul",sx:{"& li":{display:"flex"}},children:i.map((e=>(0,N.jsx)("li",{children:(0,N.jsxs)(O.A,{onClick:()=>s(e),sx:{gap:2,py:1.5,px:2.5,typography:"subtitle2"},children:[(0,N.jsx)(P.A,{alt:e.name,src:e.avatarUrl}),e.name]})},e.id)))})})]})}var de=i(63789);function ce(e){var n;let{message:i="",recipients:s,me:t}=e;const o=s.length>1,a={id:(0,de.gZ)(),attachments:[],body:i,contentType:"text",createdAt:(0,$.LX)({minutes:1}),senderId:t.id};return{messageData:a,conversationData:{id:o?(0,de.gZ)():null===(n=s[0])||void 0===n?void 0:n.id,messages:[a],participants:[...s,t],type:o?"GROUP":"ONE_TO_ONE",unreadCount:0}}}const xe=320,pe=96;function he(e){let{loading:n,contacts:i,collapseNav:s,conversations:t,selectedConversationId:a}=e;const d=(0,r.rd)(),{user:c}=(0,b.E)(),x=(0,C.A)(),p=(0,k.A)(x.breakpoints.up("md")),{openMobile:h,onOpenMobile:u,onCloseMobile:v,onCloseDesktop:m,collapseDesktop:j,onCollapseDesktop:E}=s,[S,O]=(0,o.useState)({query:"",results:[]}),U=(0,o.useMemo)((()=>({id:`${null===c||void 0===c?void 0:c.id}`,role:`${null===c||void 0===c?void 0:c.role}`,email:`${null===c||void 0===c?void 0:c.email}`,address:`${null===c||void 0===c?void 0:c.address}`,name:`${null===c||void 0===c?void 0:c.displayName}`,lastActivity:(0,$.Ec)(),avatarUrl:`${null===c||void 0===c?void 0:c.photoURL}`,phoneNumber:`${null===c||void 0===c?void 0:c.phoneNumber}`,status:"online"})),[c]);(0,o.useEffect)((()=>{p||m()}),[m,p]);const G=(0,o.useCallback)((()=>{p?E():v()}),[p,v,E]),P=(0,o.useCallback)((()=>{p||v(),d.push(l.f.dashboard.chat)}),[p,v,d]),F=(0,o.useCallback)((e=>{if(O((n=>({...n,query:e}))),e){const n=i.filter((n=>n.name.toLowerCase().includes(e.toLowerCase())));O((e=>({...e,results:n})))}}),[i]),L=(0,o.useCallback)((()=>{O({query:"",results:[]})}),[]),z=(0,o.useCallback)((async e=>{L();const n=e=>d.push(`${l.f.dashboard.chat}?id=${e}`);try{if(t.allIds.includes(e.id))return void n(e.id);const s=i.find((n=>n.id===e.id));if(!s)return void console.error("Recipient not found");const{conversationData:o}=ce({recipients:[s],me:U}),a=await g(o);a&&a.conversation||console.error("Failed to create conversation"),n(a.conversation.id)}catch(s){console.error("Error handling click result:",s)}}),[i,t.allIds,L,U,d]),_=()=>(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(y.A,{sx:{p:2.5,pb:0,display:"flex",alignItems:"center",justifyContent:"center"},children:[!j&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ee,{}),(0,N.jsx)(y.A,{sx:{flexGrow:1}})]}),(0,N.jsx)(w.A,{onClick:G,children:(0,N.jsx)(D.W,{icon:j?"eva:arrow-ios-forward-fill":"eva:arrow-ios-back-fill"})}),!j&&(0,N.jsx)(w.A,{onClick:P,children:(0,N.jsx)(D.W,{width:24,icon:"solar:user-plus-bold"})})]}),(0,N.jsx)(y.A,{sx:{p:2.5,pt:0},children:!j&&(0,N.jsx)(W.x,{onClickAway:L,children:(0,N.jsx)(A.A,{fullWidth:!0,value:S.query,onChange:e=>F(e.target.value),placeholder:"Search contacts...",slotProps:{input:{startAdornment:(0,N.jsx)(I.A,{position:"start",children:(0,N.jsx)(D.W,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}},sx:{mt:2.5}})})}),n?(0,N.jsx)(te,{}):(0,N.jsx)(R.Z,{sx:{pb:1},children:S.query&&t.allIds.length?(0,N.jsx)(re,{query:S.query,results:S.results,onClickResult:z}):(0,N.jsx)("nav",{children:(0,N.jsx)(y.A,{component:"ul",children:t.allIds.map((e=>(0,N.jsx)(M,{collapse:j,conversation:t.byId[e],selected:e===a,onCloseMobile:v},e)))})})})]});return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(T,{onClick:u,sx:{display:{md:"none"}},children:(0,N.jsx)(D.W,{width:16,icon:"solar:users-group-rounded-bold"})}),(0,N.jsx)(y.A,{sx:{minHeight:0,flex:"1 1 auto",width:xe,flexDirection:"column",display:{xs:"none",md:"flex"},borderRight:`solid 1px ${x.vars.palette.divider}`,transition:x.transitions.create(["width"],{duration:x.transitions.duration.shorter}),...j&&{width:pe}},children:_()}),(0,N.jsx)(f.Ay,{open:h,onClose:v,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:xe}},children:_()})]})}function ue(e){let{slots:n,sx:i,...s}=e;return(0,N.jsxs)(ve,{sx:i,...s,children:[(0,N.jsx)(ge,{children:n.nav}),(0,N.jsxs)(je,{children:[(0,N.jsx)(me,{children:n.header}),(0,N.jsxs)(be,{children:[(0,N.jsx)(ye,{children:n.main}),(0,N.jsx)(fe,{children:n.details})]})]})]})}const ve=(0,E.Ay)("div")((e=>{let{theme:n}=e;return{minHeight:0,flex:"1 1 0",display:"flex",position:"relative",boxShadow:n.vars.customShadows.card,borderRadius:2*n.shape.borderRadius,backgroundColor:n.vars.palette.background.paper}})),me=(0,E.Ay)("div")((e=>{let{theme:n}=e;return{height:72,flexShrink:0,display:"flex",alignItems:"center",padding:n.spacing(1,1,1,2.5),borderBottom:`solid 1px ${n.vars.palette.divider}`}})),ge=(0,E.Ay)("div")((()=>({display:"flex",flexDirection:"column"}))),je=(0,E.Ay)("div")((()=>({minWidth:0,display:"flex",flex:"1 1 auto",flexDirection:"column"}))),be=(0,E.Ay)("div")((()=>({minHeight:0,display:"flex",flex:"1 1 auto"}))),ye=(0,E.Ay)("div")((()=>({minWidth:0,display:"flex",flex:"1 1 auto",flexDirection:"column"}))),fe=(0,E.Ay)("div")((()=>({minHeight:0,display:"flex",flexDirection:"column"})));var Ae=i(30279),Ce=i(83462),we=i(35316);function ke(e){let{participant:n,open:i,onClose:s}=e;return(0,N.jsxs)(Ce.A,{fullWidth:!0,maxWidth:"xs",open:i,onClose:s,children:[(0,N.jsx)(w.A,{onClick:s,sx:{position:"absolute",right:8,top:8},children:(0,N.jsx)(D.W,{icon:"mingcute:close-line"})}),(0,N.jsxs)(we.A,{sx:{py:5,px:3,display:"flex"},children:[(0,N.jsx)(P.A,{alt:n.name,src:n.avatarUrl,sx:{width:96,height:96,mr:3}}),(0,N.jsxs)(ne.A,{spacing:1,children:[(0,N.jsx)(a.A,{variant:"caption",sx:{color:"primary.main"},children:n.role}),(0,N.jsx)(a.A,{variant:"subtitle1",children:n.name}),(0,N.jsxs)(y.A,{sx:{display:"flex",typography:"caption",color:"text.disabled"},children:[(0,N.jsx)(D.W,{icon:"mingcute:location-fill",width:16,sx:{flexShrink:0,mr:.5,mt:"2px"}}),n.address]}),(0,N.jsxs)(y.A,{sx:{gap:1,pt:1.5,display:"flex"},children:[(0,N.jsx)(w.A,{size:"small",color:"error",sx:[e=>({borderRadius:1,bgcolor:(0,de.IG)(e.vars.palette.error.mainChannel,.08),"&:hover":{bgcolor:(0,de.IG)(e.vars.palette.error.mainChannel,.16)}})],children:(0,N.jsx)(D.W,{width:18,icon:"solar:phone-bold"})}),(0,N.jsx)(w.A,{size:"small",color:"info",sx:[e=>({borderRadius:1,bgcolor:(0,de.IG)(e.vars.palette.info.mainChannel,.08),"&:hover":{bgcolor:(0,de.IG)(e.vars.palette.info.mainChannel,.16)}})],children:(0,N.jsx)(D.W,{width:18,icon:"solar:chat-round-dots-bold"})}),(0,N.jsx)(w.A,{size:"small",color:"primary",sx:[e=>({borderRadius:1,bgcolor:(0,de.IG)(e.vars.palette.primary.mainChannel,.08),"&:hover":{bgcolor:(0,de.IG)(e.vars.palette.primary.mainChannel,.16)}})],children:(0,N.jsx)(D.W,{width:18,icon:"fluent:mail-24-filled"})}),(0,N.jsx)(w.A,{size:"small",color:"secondary",sx:[e=>({borderRadius:1,bgcolor:(0,de.IG)(e.vars.palette.secondary.mainChannel,.08),"&:hover":{bgcolor:(0,de.IG)(e.vars.palette.secondary.mainChannel,.16)}})],children:(0,N.jsx)(D.W,{width:18,icon:"solar:videocamera-record-bold"})})]})]})]})]})}function Ie(e){let{participants:n}=e;const i=(0,z.Cg)(!0),[s,t]=(0,o.useState)(null),a=(0,o.useCallback)((e=>{t(e)}),[]),l=(0,o.useCallback)((()=>{t(null)}),[]),r=n.length;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(U,{selected:i.value,disabled:!r,onClick:i.onToggle,children:`In room (${r})`}),(0,N.jsx)(Ae.A,{in:i.value,children:(0,N.jsx)(N.Fragment,{children:n.map((e=>(0,N.jsxs)(O.A,{onClick:()=>a(e),children:[(0,N.jsx)(G.A,{variant:e.status,badgeContent:"",children:(0,N.jsx)(P.A,{alt:e.name,src:e.avatarUrl})}),(0,N.jsx)(L.A,{primary:e.name,secondary:e.role,slotProps:{primary:{noWrap:!0},secondary:{noWrap:!0,sx:{typography:"caption"}}},sx:{ml:2}})]},e.id)))})}),s&&(0,N.jsx)(ke,{participant:s,open:!!s,onClose:l})]})}function We(e){let{participant:n}=e;const i=(0,z.Cg)(!0);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(ne.A,{alignItems:"center",sx:{py:5},children:[(0,N.jsx)(P.A,{alt:null===n||void 0===n?void 0:n.name,src:null===n||void 0===n?void 0:n.avatarUrl,sx:{width:96,height:96,mb:2}}),(0,N.jsx)(a.A,{variant:"subtitle1",children:null===n||void 0===n?void 0:n.name}),(0,N.jsx)(a.A,{variant:"body2",sx:{color:"text.secondary",mt:.5},children:null===n||void 0===n?void 0:n.role})]}),(0,N.jsx)(U,{selected:i.value,onClick:i.onToggle,children:"Information"}),(0,N.jsx)(Ae.A,{in:i.value,children:(0,N.jsx)(ne.A,{spacing:2,sx:{px:2,py:2.5},children:[{icon:"mingcute:location-fill",value:null===n||void 0===n?void 0:n.address},{icon:"solar:phone-bold",value:null===n||void 0===n?void 0:n.phoneNumber},{icon:"fluent:mail-24-filled",value:null===n||void 0===n?void 0:n.email}].map((e=>(0,N.jsxs)(y.A,{sx:{gap:1,display:"flex",typography:"body2",wordBreak:"break-all"},children:[(0,N.jsx)(D.W,{icon:e.icon,sx:{flexShrink:0,color:"text.disabled"}}),e.value]},e.icon)))})})]})}var $e=i(16994);function De(e){let{attachments:n}=e;const i=(0,z.Cg)(!0),s=n.length;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(U,{selected:i.value,disabled:!s,onClick:i.onToggle,children:`Attachments (${s})`}),!!s&&(0,N.jsx)(Ae.A,{in:i.value,children:(0,N.jsx)(ne.A,{spacing:2,sx:{p:2},children:n.map(((e,n)=>(0,N.jsxs)(y.A,{sx:{gap:1.5,display:"flex",alignItems:"center"},children:[(0,N.jsx)($e.NM,{imageView:!0,file:e.preview,onDownload:()=>console.info("DOWNLOAD"),slotProps:{icon:{sx:{width:24,height:24}}},sx:{width:40,height:40,bgcolor:"background.neutral"}}),(0,N.jsx)(L.A,{primary:e.name,secondary:(0,$.uK)(e.createdAt),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}},secondary:{noWrap:!0,sx:{mt:.25,typography:"caption",color:"text.disabled"}}}})]},e.name+n)))})})]})}const Re=280,Ee=320;function Se(e){let{collapseNav:n,participants:i,messages:s,loading:t,sx:o,...a}=e;const{collapseDesktop:l,openMobile:r,onCloseMobile:d}=n,c=i.length>1,x=s.map((e=>e.attachments)).flat(1)||[],p=()=>t?(0,N.jsx)(ae,{}):(0,N.jsx)(R.Z,{children:(0,N.jsxs)("div",{children:[c?(0,N.jsx)(Ie,{participants:i}):(0,N.jsx)(We,{participant:i[0]}),(0,N.jsx)(De,{attachments:x})]})});return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(y.A,{sx:[e=>({minHeight:0,flex:"1 1 auto",width:Re,flexDirection:"column",display:{xs:"none",lg:"flex"},borderLeft:`solid 1px ${e.vars.palette.divider}`,transition:e.transitions.create(["width"],{duration:e.transitions.duration.shorter}),...l&&{width:0}}),...Array.isArray(o)?o:[o]],...a,children:!l&&p()}),(0,N.jsx)(f.Ay,{anchor:"right",open:r,onClose:d,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:Ee}},children:p()})]})}var Oe=i(36930),Ne=i(57653);function Ue(e){let{message:n,participants:i,onOpenLightbox:s}=e;const{user:t}=(0,b.E)(),{me:o,senderDetails:l,hasImage:r}=function(e){var n,i;let{message:s,participants:t,currentUserId:o}=e;const a=t.find((e=>e.id===s.senderId)),l=s.senderId===o,r=l?{type:"me"}:{avatarUrl:null===a||void 0===a?void 0:a.avatarUrl,firstName:null!==(n=null===a||void 0===a||null===(i=a.name)||void 0===i?void 0:i.split(" ")[0])&&void 0!==n?n:"Unknown"};return{hasImage:"image"===s.contentType,me:l,senderDetails:r}}({message:n,participants:i,currentUserId:`${null===t||void 0===t?void 0:t.id}`}),{firstName:d,avatarUrl:c}=l,{body:x,createdAt:p}=n;return n.body?(0,N.jsxs)(y.A,{sx:{mb:5,display:"flex",justifyContent:o?"flex-end":"unset"},children:[!o&&(0,N.jsx)(P.A,{alt:d,src:c,sx:{width:32,height:32,mr:2}}),(0,N.jsxs)(ne.A,{alignItems:o?"flex-end":"flex-start",children:[(0,N.jsxs)(a.A,{noWrap:!0,variant:"caption",sx:{mb:1,color:"text.disabled",...!o&&{mr:"auto"}},children:[!o&&`${d}, `,(0,$.kH)(p)]}),(0,N.jsxs)(y.A,{sx:{display:"flex",alignItems:"center",position:"relative","&:hover":{"& .message-actions":{opacity:1}}},children:[(0,N.jsx)(ne.A,{sx:{p:1.5,minWidth:48,maxWidth:320,borderRadius:1,typography:"body2",bgcolor:"background.neutral",...o&&{color:"grey.800",bgcolor:"primary.lighter"},...r&&{p:0,bgcolor:"transparent"}},children:r?(0,N.jsx)(y.A,{component:"img",alt:"Attachment",src:x,onClick:()=>s(x),sx:{width:400,height:"auto",borderRadius:1.5,cursor:"pointer",objectFit:"cover",aspectRatio:"16/11","&:hover":{opacity:.9}}}):x}),(0,N.jsxs)(y.A,{className:"message-actions",sx:e=>({pt:.5,left:0,opacity:0,top:"100%",display:"flex",position:"absolute",transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.shorter}),...o&&{right:0,left:"unset"}}),children:[(0,N.jsx)(w.A,{size:"small",children:(0,N.jsx)(D.W,{icon:"solar:reply-bold",width:16})}),(0,N.jsx)(w.A,{size:"small",children:(0,N.jsx)(D.W,{icon:"eva:smiling-face-fill",width:16})}),(0,N.jsx)(w.A,{size:"small",children:(0,N.jsx)(D.W,{icon:"solar:trash-bin-trash-bold",width:16})})]})]})]})]}):null}function Te(e){let{messages:n=[],participants:i,loading:s}=e;const{messagesEndRef:t}=function(e){const n=(0,o.useRef)(null),i=(0,o.useCallback)((()=>{e&&n.current&&n.current&&(n.current.scrollTop=n.current.scrollHeight)}),[e]);return(0,o.useEffect)((()=>{i()}),[e]),{messagesEndRef:n}}(n),a=n.filter((e=>"image"===e.contentType)).map((e=>({src:e.body}))),l=(0,Ne.x)(a);return s?(0,N.jsx)(ne.A,{sx:{flex:"1 1 auto",position:"relative"},children:(0,N.jsx)(Oe.A,{color:"inherit",sx:{top:0,left:0,width:1,height:2,borderRadius:0,position:"absolute"}})}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(R.Z,{ref:t,sx:{px:3,pt:5,pb:3,flex:"1 1 auto"},children:n.map((e=>(0,N.jsx)(Ue,{message:e,participants:i,onOpenLightbox:()=>l.onOpen(e.body)},e.id)))}),(0,N.jsx)(Ne.Y,{slides:a,open:l.open,close:l.onClose,index:l.selected})]})}function Ge(e){let{disabled:n,recipients:i,onAddRecipients:s,selectedConversationId:t}=e;const a=(0,r.rd)(),{user:d}=(0,b.E)(),c=(0,o.useRef)(null),[x,m]=(0,o.useState)(""),j=(0,o.useMemo)((()=>({id:`${null===d||void 0===d?void 0:d.id}`,role:`${null===d||void 0===d?void 0:d.role}`,email:`${null===d||void 0===d?void 0:d.email}`,address:`${null===d||void 0===d?void 0:d.address}`,name:`${null===d||void 0===d?void 0:d.displayName}`,lastActivity:(0,$.Ec)(),avatarUrl:`${null===d||void 0===d?void 0:d.photoURL}`,phoneNumber:`${null===d||void 0===d?void 0:d.phoneNumber}`,status:"online"})),[d]),{messageData:f,conversationData:A}=ce({message:x,recipients:i,me:j}),C=(0,o.useCallback)((()=>{c.current&&c.current.click()}),[]),k=(0,o.useCallback)((e=>{m(e.target.value)}),[]),I=(0,o.useCallback)((async e=>{if("Enter"===e.key&&x)try{if(t)await async function(e,n){const i=[v,{params:{endpoint:"conversations"}}],s=[v,{params:{conversationId:e,endpoint:"conversation"}}];if(u){const i={conversationId:e,messageData:n};await h.Ay.put(v,i)}(0,p.k)(s,(e=>{const i=e.conversation,s={...i,messages:[...i.messages,n]};return{...e,conversation:s}}),!1),(0,p.k)(i,(i=>{const s=i.conversations.map((i=>i.id===e?{...i,messages:[...i.messages,n]}:i));return{...i,conversations:s}}),!1)}(t,f);else{const e=await g(A);a.push(`${l.f.dashboard.chat}?id=${e.conversation.id}`),s([])}}catch(n){console.error(n)}finally{m("")}}),[A,x,f,s,a,t]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(X.Ay,{name:"chat-message",id:"chat-message-input",value:x,onKeyUp:I,onChange:k,placeholder:"Type a message",disabled:n,startAdornment:(0,N.jsx)(w.A,{children:(0,N.jsx)(D.W,{icon:"eva:smiling-face-fill"})}),endAdornment:(0,N.jsxs)(y.A,{sx:{flexShrink:0,display:"flex"},children:[(0,N.jsx)(w.A,{onClick:C,children:(0,N.jsx)(D.W,{icon:"solar:gallery-add-bold"})}),(0,N.jsx)(w.A,{onClick:C,children:(0,N.jsx)(D.W,{icon:"eva:attach-2-fill"})}),(0,N.jsx)(w.A,{children:(0,N.jsx)(D.W,{icon:"solar:microphone-bold"})})]}),sx:[e=>({px:1,height:56,flexShrink:0,borderTop:`solid 1px ${e.vars.palette.divider}`})]}),(0,N.jsx)("input",{type:"file",ref:c,style:{display:"none"}})]})}var Pe=i(86826);function Fe(e){let{collapseNav:n,participants:i,loading:s}=e;const t=(0,C.A)(),a=(0,k.A)(t.breakpoints.up("lg")),l=(0,z.fP)(),r=i.length>1,d=i[0],{collapseDesktop:c,onCollapseDesktop:x,onOpenMobile:p}=n,h=(0,o.useCallback)((()=>{a?x():p()}),[a]);if(s)return(0,N.jsx)(oe,{});return(0,N.jsxs)(N.Fragment,{children:[r?(0,N.jsx)(F.A,{max:3,sx:{[`& .${Pe.A.avatar}`]:{width:32,height:32}},children:i.map((e=>(0,N.jsx)(P.A,{alt:e.name,src:e.avatarUrl},e.id)))}):(0,N.jsxs)(y.A,{sx:{gap:2,display:"flex",alignItems:"center"},children:[(0,N.jsx)(G.A,{variant:null===d||void 0===d?void 0:d.status,badgeContent:"",children:(0,N.jsx)(P.A,{src:null===d||void 0===d?void 0:d.avatarUrl,alt:null===d||void 0===d?void 0:d.name})}),(0,N.jsx)(L.A,{primary:null===d||void 0===d?void 0:d.name,secondary:"offline"===(null===d||void 0===d?void 0:d.status)?(0,$.kH)(null===d||void 0===d?void 0:d.lastActivity):null===d||void 0===d?void 0:d.status})]}),(0,N.jsxs)(y.A,{sx:{flexGrow:1,display:"flex",justifyContent:"flex-end"},children:[(0,N.jsx)(w.A,{children:(0,N.jsx)(D.W,{icon:"solar:phone-bold"})}),(0,N.jsx)(w.A,{children:(0,N.jsx)(D.W,{icon:"solar:videocamera-record-bold"})}),(0,N.jsx)(w.A,{onClick:h,children:(0,N.jsx)(D.W,{icon:c?"ri:sidebar-fold-fill":"ri:sidebar-unfold-fill"})}),(0,N.jsx)(w.A,{onClick:l.onOpen,children:(0,N.jsx)(D.W,{icon:"eva:more-vertical-fill"})})]}),(0,N.jsx)(Q.t,{open:l.open,anchorEl:l.anchorEl,onClose:l.onClose,children:(0,N.jsxs)(q.A,{children:[(0,N.jsxs)(Z.A,{onClick:()=>l.onClose(),children:[(0,N.jsx)(D.W,{icon:"solar:bell-off-bold"}),"Hide notifications"]}),(0,N.jsxs)(Z.A,{onClick:()=>l.onClose(),children:[(0,N.jsx)(D.W,{icon:"solar:forbidden-circle-bold"}),"Block"]}),(0,N.jsxs)(Z.A,{onClick:()=>l.onClose(),children:[(0,N.jsx)(D.W,{icon:"solar:danger-triangle-bold"}),"Report"]}),(0,N.jsx)(H.A,{sx:{borderStyle:"dashed"}}),(0,N.jsxs)(Z.A,{onClick:()=>l.onClose(),sx:{color:"error.main"},children:[(0,N.jsx)(D.W,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}var Le=i(26487),Me=i(8710);function ze(e){let{contacts:n,onAddRecipients:i}=e;const[s,t]=(0,o.useState)(""),l=(0,o.useCallback)((e=>{t(""),i(e)}),[i]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(a.A,{variant:"subtitle2",sx:{color:"text.primary",mr:2},children:"To:"}),(0,N.jsx)(Me.A,{sx:{minWidth:{md:320},flexGrow:{xs:1,md:"unset"}},multiple:!0,limitTags:3,popupIcon:null,defaultValue:[],disableCloseOnSelect:!0,noOptionsText:(0,N.jsx)(le.c,{query:s}),onChange:(e,n)=>l(n),onInputChange:(e,n)=>t(n),options:n,getOptionLabel:e=>e.name,isOptionEqualToValue:(e,n)=>e.id===n.id,renderInput:e=>(0,N.jsx)(A.A,{...e,placeholder:"+ Recipients"}),renderOption:(e,n,i)=>{let{selected:s}=i;return(0,o.createElement)("li",{...e,key:n.id},(0,N.jsxs)(y.A,{sx:{mr:1,width:32,height:32,overflow:"hidden",borderRadius:"50%",position:"relative"},children:[(0,N.jsx)(P.A,{alt:n.name,src:n.avatarUrl,sx:{width:1,height:1}}),(0,N.jsx)(y.A,{sx:[e=>({top:0,left:0,width:1,height:1,opacity:0,display:"flex",position:"absolute",alignItems:"center",justifyContent:"center",bgcolor:(0,de.IG)(e.vars.palette.grey["900Channel"],.8),transition:e.transitions.create(["opacity"],{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.shorter}),...s&&{opacity:1,color:"primary.main"}})],children:(0,N.jsx)(D.W,{icon:"eva:checkmark-fill"})})]},n.id),n.name)},renderTags:(e,n)=>e.map(((e,i)=>(0,o.createElement)(Le.A,{...n({index:i}),key:e.id,label:e.name,avatar:(0,N.jsx)(P.A,{alt:e.name,src:e.avatarUrl}),size:"small",variant:"soft"})))})]})}function _e(){const[e,n]=(0,o.useState)(!1),[i,s]=(0,o.useState)(!1),t=(0,o.useCallback)((()=>{s((e=>!e))}),[]);return{collapseDesktop:i,onCloseDesktop:(0,o.useCallback)((()=>{s(!1)}),[]),onCollapseDesktop:t,openMobile:e,onOpenMobile:(0,o.useCallback)((()=>{n(!0)}),[]),onCloseMobile:(0,o.useCallback)((()=>{n(!1)}),[])}}function He(){var e,n;const i=(0,r.rd)(),{user:s}=(0,b.E)(),{contacts:p}=function(){const e=[v,{params:{endpoint:"contacts"}}],{data:n,isLoading:i,error:s,isValidating:t}=(0,x.Ay)(e,h.GO,m);return(0,o.useMemo)((()=>({contacts:(null===n||void 0===n?void 0:n.contacts)||[],contactsLoading:i,contactsError:s,contactsValidating:t,contactsEmpty:!i&&!t&&!(null!==n&&void 0!==n&&n.contacts.length)})),[null===n||void 0===n?void 0:n.contacts,s,i,t])}(),u=(0,r.ok)().get("id")||"",{conversations:g,conversationsLoading:y}=function(){const e=[v,{params:{endpoint:"conversations"}}],{data:n,isLoading:i,error:s,isValidating:t}=(0,x.Ay)(e,h.GO,m);return(0,o.useMemo)((()=>{const e=null!==n&&void 0!==n&&n.conversations.length?(0,c.p)(n.conversations,(e=>e.id)):{},o=Object.keys(e);return{conversations:{byId:e,allIds:o},conversationsLoading:i,conversationsError:s,conversationsValidating:t,conversationsEmpty:!i&&!t&&!o.length}}),[null===n||void 0===n?void 0:n.conversations,s,i,t])}(),{conversation:f,conversationError:A,conversationLoading:C}=function(e){const n=e?[v,{params:{conversationId:e,endpoint:"conversation"}}]:"",{data:i,isLoading:s,error:t,isValidating:a}=(0,x.Ay)(n,h.GO,m);return(0,o.useMemo)((()=>({conversation:null===i||void 0===i?void 0:i.conversation,conversationLoading:s,conversationError:t,conversationValidating:a,conversationEmpty:!s&&!a&&!(null!==i&&void 0!==i&&i.conversation)})),[null===i||void 0===i?void 0:i.conversation,t,s,a])}(u),w=_e(),k=_e(),[I,W]=(0,o.useState)([]);(0,o.useEffect)((()=>{u||(0,o.startTransition)((()=>{i.push(l.f.dashboard.chat)}))}),[A,i,u]);const $=(0,o.useCallback)((e=>{W(e)}),[]),D=f?f.participants.filter((e=>e.id!==`${null===s||void 0===s?void 0:s.id}`)):[],R=u&&f;return(0,N.jsxs)(d.KG,{maxWidth:!1,sx:{display:"flex",flex:"1 1 auto",flexDirection:"column"},children:[(0,N.jsx)(a.A,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Chat"}),(0,N.jsx)(ue,{slots:{header:R?(0,N.jsx)(Fe,{collapseNav:w,participants:D,loading:C}):(0,N.jsx)(ze,{contacts:p,onAddRecipients:$}),nav:(0,N.jsx)(he,{contacts:p,conversations:g,selectedConversationId:u,collapseNav:k,loading:y}),main:(0,N.jsxs)(N.Fragment,{children:[u?A?(0,N.jsx)(j.H,{title:A.message,imgUrl:`${t.P.assetsDir}/assets/icons/empty/ic-chat-empty.svg`}):(0,N.jsx)(Te,{messages:null!==(e=null===f||void 0===f?void 0:f.messages)&&void 0!==e?e:[],participants:D,loading:C}):(0,N.jsx)(j.H,{title:"Good morning!",description:"Write something awesome...",imgUrl:`${t.P.assetsDir}/assets/icons/empty/ic-chat-active.svg`}),(0,N.jsx)(Ge,{recipients:I,onAddRecipients:$,selectedConversationId:u,disabled:!I.length&&!u})]}),details:R&&(0,N.jsx)(Se,{collapseNav:w,participants:D,loading:C,messages:null!==(n=null===f||void 0===f?void 0:f.messages)&&void 0!==n?n:[]})}})]})}const Ve={title:`Chat | Dashboard - ${t.P.appName}`};function qe(){return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(s.mg,{children:(0,N.jsxs)("title",{children:[" ",Ve.title]})}),(0,N.jsx)(He,{})]})}}}]);
//# sourceMappingURL=7888.002d6680.chunk.js.map